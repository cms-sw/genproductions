#!/usr/bin/python

import os
import re
import sys
import collections

n = len(sys.argv)
if n < 2:
    print("enter process cgbh or bgth, and rtt and rtc values")
    print("example: ./.... cg 0.4 1.0")
    print("example: ./.... bg 0.4 1.0")
    sys.exit()


process = sys.argv[1]
rtu = 0.0
rtt = sys.argv[2]
rtc = sys.argv[3]

mass = [200,250,300,350,400,500,600,700,800,900,1000]

d_bHplus = collections.OrderedDict({
('0.1,0.1',200 ):  0.127152,
('0.1,0.4',200 ):  1.91509 ,
('0.1,0.6',200 ):  4.29902 ,
('0.1,1.0',200 ):  11.9276 ,
('0.4,0.1',200 ):  0.246483, 
('0.4,0.4',200 ):  2.03442 , 
('0.4,0.6',200 ):  4.41835 , 
('0.4,1.0',200 ):  12.0469 , 
('0.6,0.1',200 ):  0.405592, 
('0.6,0.4',200 ):  2.19353 , 
('0.6,0.6',200 ):  4.57746 , 
('0.6,1.0',200 ):  12.206  , 
('1.0,0.1',200 ):  0.914741,  
('1.0,0.4',200 ):  2.70268 ,  
('1.0,0.6',200 ):  5.0866  ,  
('1.0,1.0',200 ):  12.7152 ,  
('0.1,0.1',250 ):  0.190329,  
('0.1,0.4',250 ):  2.42624 ,  
('0.1,0.6',250 ):  5.40746 ,  
('0.1,1.0',250 ):  14.9474 ,                  
('0.4,0.1',250 ):  0.809347,  
('0.4,0.4',250 ):  3.04526 ,  
('0.4,0.6',250 ):  6.02648 ,  
('0.4,1.0',250 ):  15.5664 ,         
('0.6,0.1',250 ):  1.6347  ,  
('0.6,0.4',250 ):  3.87062 ,  
('0.6,0.6',250 ):  6.85184 ,  
('0.6,1.0',250 ):  16.3917 ,  
('1.0,0.1',250 ):  4.27585 ,  
('1.0,0.4',250 ):  6.51176 ,  
('1.0,0.6',250 ):  9.49298 ,  
('1.0,1.0',250 ):  19.0329 ,  
('0.1,0.1',300 ):  0.259494,
('0.1,0.4',300 ):  2.94323 ,
('0.1,0.6',300 ):  6.52155 ,
('0.1,1.0',300 ):  17.9722 ,
('0.4,0.1',300 ):  1.46816 ,
('0.4,0.4',300 ):  4.1519  ,
('0.4,0.6',300 ):  7.73022 ,
('0.4,1.0',300 ):  19.1808 ,
('0.6,0.1',300 ):  3.07971 ,
('0.6,0.4',300 ):  5.76345 ,
('0.6,0.6',300 ):  9.34178 ,
('0.6,1.0',300 ):  20.7924 ,
('1.0,0.1',300 ):  8.23669 ,
('1.0,0.4',300 ):  10.9204 ,
('1.0,0.6',300 ):  14.4988 ,
('1.0,1.0',300 ):  25.9494 ,
('0.1,0.1',350 ):  0.328842,
('0.1,0.4',350 ):  3.46033 ,
('0.1,0.6',350 ):  7.63564 ,
('0.1,1.0',350 ):  20.9966 ,
('0.4,0.1',350 ):  2.13000 , 
('0.4,0.4',350 ):  5.26148 , 
('0.4,0.6',350 ):  9.43679 , 
('0.4,1.0',350 ):  22.7978 , 
('0.6,0.1',350 ):  4.53154 , 
('0.6,0.4',350 ):  7.66302 , 
('0.6,0.6',350 ):  11.8383 , 
('0.6,1.0',350 ):  25.1993 , 
('1.0,0.1',350 ):  12.2165 , 
('1.0,0.4',350 ):  15.3479 , 
('1.0,0.6',350 ):  19.5233 , 
('1.0,1.0',350 ):  32.8842 ,
('0.1,0.1',400 ):  0.397123, 
('0.1,0.4',400 ):  3.976300, 
('0.1,0.6',400 ):  8.74853 , 
('0.1,1.0',400 ):  24.0197 , 
('0.4,0.1',400 ):  2.77479 , 
('0.4,0.4',400 ):  6.35396 , 
('0.4,0.6',400 ):  11.1262 , 
('0.4,1.0',400 ):  26.3973 , 
('0.6,0.1',400 ):  5.94501 , 
('0.6,0.4',400 ):  9.52418 , 
('0.6,0.6',400 ):  14.2964 , 
('0.6,1.0',400 ):  29.5676 , 
('1.0,0.1',400 ):  16.0897 , 
('1.0,0.4',400 ):  19.6689 , 
('1.0,0.6',400 ):  24.4411 , 
('1.0,1.0',400 ):  39.7123 , 
('0.1,0.1',500 ):  0.530164, 
('0.1,0.4',500 ):  5.00462 , 
('0.1,0.6',500 ):  10.9706 , 
('0.1,1.0',500 ):  30.0616 , 
('0.4,0.1',500 ):  4.00817 , 
('0.4,0.4',500 ):  8.48263 , 
('0.4,0.6',500 ):  14.4486 , 
('0.4,1.0',500 ):  33.5396 , 
('0.6,0.1',500 ):  8.6455  , 
('0.6,0.4',500 ):  13.12   , 
('0.6,0.6',500 ):  19.0859 , 
('0.6,1.0',500 ):  38.1769 , 
('1.0,0.1',500 ):  23.485  , 
('1.0,0.4',500 ):  27.9594 , 
('1.0,0.6',500 ):  33.9254 , 
('1.0,1.0',500 ):  53.0164 , 
('0.1,0.1',600 ):  0.659534,  
('0.1,0.4',600 ):  6.02921 ,  
('0.1,0.6',600 ):  13.1888 ,  
('0.1,1.0',600 ):  36.0994 ,  
('0.4,0.1',600 ):  5.18287 ,  
('0.4,0.4',600 ):  10.5525 ,  
('0.4,0.6',600 ):  17.7121 ,  
('0.4,1.0',600 ):  40.6227 ,  
('0.6,0.1',600 ):  11.214  ,  
('0.6,0.4',600 ):  16.5837 ,  
('0.6,0.6',600 ):  23.7432 ,  
('0.6,1.0',600 ):  46.6538 ,  
('1.0,0.1',600 ):  30.5135 ,  
('1.0,0.4',600 ):  35.8832 ,  
('1.0,0.6',600 ):  43.0428 ,  
('1.0,1.0',600 ):  65.9534 ,  
('0.1,0.1',700 ):  0.78640 ,  
('0.1,0.4',700 ):  7.05125 ,  
('0.1,0.6',700 ):  15.4044 ,  
('0.1,1.0',700 ):  42.1344 ,  
('0.4,0.1',700 ):  6.31757 ,  
('0.4,0.4',700 ):  12.5824 ,  
('0.4,0.6',700 ):  20.9355 ,  
('0.4,1.0',700 ):  47.6655 ,  
('0.6,0.1',700 ):  13.6925 ,  
('0.6,0.4',700 ):  19.9573 ,  
('0.6,0.6',700 ):  28.3104 ,  
('0.6,1.0',700 ):  55.0404 ,  
('1.0,0.1',700 ):  37.2921 ,  
('1.0,0.4',700 ):  43.5569 ,  
('1.0,0.6',700 ):  51.9101 ,  
('1.0,1.0',700 ):  78.6401 ,  
('0.1,0.1',800 ):  0.911555,  
('0.1,0.4',800 ):  8.07155 ,  
('0.1,0.6',800 ):  17.6182 ,  
('0.1,1.0',800 ):  48.1675 ,  
('0.4,0.1',800 ):  7.42489 ,  
('0.4,0.4',800 ):  14.5849 ,  
('0.4,0.6',800 ):  24.1315 ,  
('0.4,1.0',800 ):  54.6808 ,  
('0.6,0.1',800 ):  16.1093 ,  
('0.6,0.4',800 ):  23.2693 ,  
('0.6,0.6',800 ):  32.816  ,  
('0.6,1.0',800 ):  63.3653 ,  
('1.0,0.1',800 ):  43.8996 ,  
('1.0,0.4',800 ):  51.0596 ,  
('1.0,0.6',800 ):  60.6062 ,  
('1.0,1.0',800 ):  91.1555 ,  
('0.1,0.1',900 ):  1.03551 ,  
('0.1,0.4',900 ):  9.09063 ,  
('0.1,0.6',900 ):  19.8308 ,  
('0.1,1.0',900 ):  54.1993 ,  
('0.4,0.1',900 ):  8.51297 ,  
('0.4,0.4',900 ):  16.5681 ,  
('0.4,0.6',900 ):  27.3082 ,  
('0.4,1.0',900 ):  61.6768 ,  
('0.6,0.1',900 ):  18.4829 ,  
('0.6,0.4',900 ):  26.538  ,  
('0.6,0.6',900 ):  37.2782 ,  
('0.6,1.0',900 ):  71.6467 ,  
('1.0,0.1',900 ):  50.3868 ,  
('1.0,0.4',900 ):  58.4419 ,  
('1.0,0.6',900 ):  69.182  ,  
('1.0,1.0',900 ):  103.551 ,  
('0.1,0.1',1000):  1.15858 , 
('0.1,0.4',1000):  10.1088 , 
('0.1,0.6',1000):  22.0425 , 
('0.1,1.0',1000):  60.2301 , 
('0.4,0.1',1000):  9.58709 , 
('0.4,0.4',1000):  18.5373 , 
('0.4,0.6',1000):  30.471  , 
('0.4,1.0',1000):  68.6586 , 
('0.6,0.1',1000):  20.8251 , 
('0.6,0.4',1000):  29.7753 , 
('0.6,0.6',1000):  41.709  , 
('0.6,1.0',1000):  79.8967 , 
('1.0,0.1',1000):  56.7867 , 
('1.0,0.4',1000):  65.737  , 
('1.0,0.6',1000):  77.6706 , 
('1.0,1.0',1000):  115.858
})

main_folder='del'
if 'cgbh' in process: 
    temp_run_card = 'cgbh/g2HDM_charged_higgs_cgbh_run_card.dat'
    temp_proc_card = 'cgbh/g2HDM_charged_higgs_cgbh_proc_card.dat'
    temp_extramodels = 'cgbh/g2HDM_charged_higgs_cgbh_extramodels.dat'
    temp_customizecards= 'cgbh/g2HDM_charged_higgs_cgbh_customizecards.dat'
if 'bgth' in process:
    temp_run_card = 'bgth/g2HDM_charged_higgs_bgth_run_card.dat'
    temp_proc_card = 'bgth/g2HDM_charged_higgs_bgth_proc_card.dat'
    temp_extramodels = 'bgth/g2HDM_charged_higgs_bgth_extramodels.dat'
    temp_customizecards= 'bgth/g2HDM_charged_higgs_bgth_customizecards.dat'        

with open(temp_customizecards) as f_cust:
    cust = f_cust.read().splitlines()

input_sel = rtt+","+rtc
print(input_sel)
for ind in mass:
    width = d_bHplus[input_sel,ind]
    print(input_sel,ind, width)
    f_name = "charged_higgs_"+process+"_M"+str(ind)+"_rhotu"+str(rtu).replace('.','') \
		 +"_rhott"+str(rtt).replace('.','')+"_rhotc"+str(rtc).replace('.','') 
    print("creating folder: "+f_name)
    os.system('mkdir -p %s' %f_name)
    os.system('cp '+process+'/g2HDM_charged_higgs_'+process+'_extramodels.dat '+f_name+'/g2HDM_'+\
		f_name+'_extramodels.dat')
    os.system('cp '+process+'/g2HDM_charged_higgs_'+process+'_run_card.dat '+f_name+'/g2HDM_'+\
		f_name+'_run_card.dat')
    print(cust)
    print(str(cust[0].split(' ')[4]))  
    print(str(cust[1].split(' ')[4]))  
    print(str(cust[2].split(' ')[4]))  
    print(str(cust[3].split(' ')[4]))  
    print(str(cust[4].split(' ')[4]))  
    cust[0]=cust[0].replace(str(cust[0].split(' ')[4]),str(rtt))
    cust[1]=cust[1].replace(str(cust[1].split(' ')[4]),str(rtu))
    cust[2]=cust[2].replace(str(cust[2].split(' ')[4]),str(rtc))
    old = str(cust[3].split(' ')[4])
    temp = str(ind).join(str(cust[3]).rsplit(old,1))
    cust[3] = temp
    cust[4]=cust[4].replace(str(cust[4].split(' ')[4]),str(width))
    proc = open(temp_proc_card,'r')
    f_name_proc = f_name+'/g2HDM_'+f_name+'_proc_card.dat'
    f_name_cust = f_name+'/g2HDM_'+f_name+'_customizecards.dat'  
    print(f_name_proc)
    print(f_name_cust) 
    with open(f_name_proc,'w') as proc_file:
        for line in proc:
            line = line.replace('g2HDM_charged_higgs_'+process,'g2HDM_'+f_name)
            proc_file.write(line)
    with open(f_name_cust,'w') as cust_file:
        for el in cust:
            print(el, file=cust_file)
