// Declarations for the interface of the ninja library to the Fortran
// code generated by GoSam.


#ifndef QUADNINJA_GOSAM_INTERFACE_HH
#define QUADNINJA_GOSAM_INTERFACE_HH

#include <quadninja/ninja.hh>

namespace quadninja {
  namespace gosam_interface {

    // Function which evaluates the numerator
    typedef void (*Numerator)(const int & ncut, const ComplexMomentum & Q,
                              const Complex & mu2, Complex & result);

    // Routine which returns the t-expansion
    typedef void (*Numerator_t3)(const int & ncut,
                                 const ComplexMomentum & a,
                                 const ComplexMomentum & b,
                                 const ComplexMomentum & c,
                                 const Complex & param,
                                 const int & ndeg,
                                 Complex * coeffs);

    // Routine which returns the t-expansion
    typedef void (*Numerator_t2)(const int & ncut,
                                 const ComplexMomentum & a0,
                                 const ComplexMomentum & a1,
                                 const ComplexMomentum & b,
                                 const ComplexMomentum & c,
                                 const Complex * param,
                                 const int & ndeg,
                                 Complex * coeffs);

    // Routine which returns the mu-expansion
    typedef void (*Numerator_d)(const int & ncut,
                                const ComplexMomentum a[],
                                Complex * coeffs);

  } // namespace gosam_interface
} // namespace quadninja

extern "C"{

  // These are the routines to be called by the Fortran code in GoSam

  // Selects a subset of propagators

  // Recution with real masses
  void quadninjago_diag_rm(quadninja::gosam_interface::Numerator numerator,
                       quadninja::gosam_interface::Numerator_t3 numerator_t3,
                       quadninja::gosam_interface::Numerator_t2 numerator_t2,
                       quadninja::gosam_interface::Numerator_d numerator_d,
                       const int & nprops_group,
                       const int & nprops, const int & rk,
                       const int * indices,
                       const quadninja::RealMomentum * Vi,
                       const quadninja::Real * msq,
                       quadninja::Real * g_mat_data,
                       const quadninja::Real & scale2,
                       const int & istop,
                       quadninja::Complex tot[3],
                       quadninja::Complex & totr,
                       int & return_status);

  // Reduction with complex masses
  void quadninjago_diag_cm(quadninja::gosam_interface::Numerator numerator,
                       quadninja::gosam_interface::Numerator_t3 numerator_t3,
                       quadninja::gosam_interface::Numerator_t2 numerator_t2,
                       quadninja::gosam_interface::Numerator_d numerator_d,
                       const int & nprops_group,
                       const int & nprops, const int & rk,
                       const int * indices,
                       const quadninja::RealMomentum * Vi,
                       const quadninja::Complex * msq,
                       quadninja::Real * g_mat_data,
                       const quadninja::Real & scale2,
                       const int & istop,
                       quadninja::Complex tot[3],
                       quadninja::Complex & totr,
                       int & return_status);

  // Reduction with massless loop-propagators
  void quadninjago_diag_nm(quadninja::gosam_interface::Numerator numerator,
                       quadninja::gosam_interface::Numerator_t3 numerator_t3,
                       quadninja::gosam_interface::Numerator_t2 numerator_t2,
                       quadninja::gosam_interface::Numerator_d numerator_d,
                       const int & nprops_group,
                       const int & nprops, const int & rk,
                       const int * indices,
                       const quadninja::RealMomentum * Vi,
                       quadninja::Real * g_mat_data,
                       const quadninja::Real & scale2,
                       const int & istop,
                       quadninja::Complex tot[3],
                       quadninja::Complex & totr,
                       int & return_status);


  // Clear the cache of the master integrals
  void quadninjago_clear_integral_cache();

  // Free the cache of the master integrals in OneLoop interface
  void quadninjago_free_integral_cache();

  // Set the verbosity
  void quadninjago_set_verbosity(int val);

  // Set the the test flag
  void quadninjago_set_test(int val);

  // Set the tolerance for the relative errors in the tests
  void quadninjago_set_test_tolerance(const quadninja::Real & val);

  // Set number of digits in the output
  void quadninjago_set_output_precision(int val);

  // Select the integral library
  void quadninjago_set_integral_library(int flag);

} // extern "C"

#endif // QUADNINJA_GOSAM_INTERFACE_HH
